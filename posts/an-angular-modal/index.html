<!doctype html><html lang="en"><head><title data-react-helmet="true">An Angular Modal</title><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" name="generator" content="Phenomic 0.21.1"/><meta data-react-helmet="true" property="og:site_name" content="filoblog"/><meta data-react-helmet="true" name="twitter:site" content="@c_filoteo"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="An Angular Modal"/><meta data-react-helmet="true" property="og:url" content="https://filoxo.github.io/posts/an-angular-modal/"/><meta data-react-helmet="true" property="og:image" content="https://filoxo.github.io/assets/bldg.jpg"/><meta data-react-helmet="true" property="og:description" content="This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the‚Ä¶"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="An Angular Modal"/><meta data-react-helmet="true" name="twitter:creator" content="@c_filoteo"/><meta data-react-helmet="true" name="twitter:description" content="This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the‚Ä¶"/><meta data-react-helmet="true" name="twitter:image" content="https://filoxo.github.io/assets/bldg.jpg"/><meta data-react-helmet="true" name="description" content="This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the‚Ä¶"/><link rel="stylesheet" href="/phenomic.browser.4b24f5ff56450456ebf3.css"/><script data-react-helmet="true" src="https://cdn.polyfill.io/v2/polyfill.min.js"></script></head><body><div id="phenomic"><div class="_2Mf6m" data-reactroot="" data-reactid="1" data-react-checksum="903580983"><div hidden="" data-reactid="2"><!-- react-empty: 3 --><!-- react-empty: 4 --><style data-reactid="5">@-ms-viewport { width: device-width; }</style></div><header class="_2gGRo" data-reactid="6"><nav class="_2frUm" data-reactid="7"><div class="_37D8R" data-reactid="8"><a class="Ezg15" href="/" data-reactid="9">Home</a></div><div class="_3VLYQ" data-reactid="10"><a href="https://twitter.com/c_filoteo" class="Ezg15" data-reactid="11"><span class="SVGInline SVGInline--cleaned" data-reactid="12"><svg class="SVGInline-svg SVGInline--cleaned-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 4.557a9.83 9.83 0 0 1-2.828.775 4.932 4.932 0 0 0 2.165-2.724 9.864 9.864 0 0 1-3.127 1.195 4.916 4.916 0 0 0-3.594-1.555c-3.18 0-5.515 2.966-4.797 6.045A13.978 13.978 0 0 1 1.67 3.15a4.93 4.93 0 0 0 1.524 6.573 4.903 4.903 0 0 1-2.23-.616c-.053 2.28 1.582 4.415 3.95 4.89a4.935 4.935 0 0 1-2.224.084 4.928 4.928 0 0 0 4.6 3.42A9.9 9.9 0 0 1 0 19.54a13.94 13.94 0 0 0 7.548 2.212c9.142 0 14.307-7.72 13.995-14.646A10.025 10.025 0 0 0 24 4.556z"/></svg></span><span class="sr-text" data-reactid="13">Twitter</span></a><a href="https://github.com/filoxo/" class="Ezg15" data-reactid="14"><span class="SVGInline SVGInline--cleaned" data-reactid="15"><svg class="SVGInline-svg SVGInline--cleaned-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.6.11.793-.26.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.09-.745.083-.73.083-.73 1.205.085 1.84 1.238 1.84 1.238 1.07 1.834 2.806 1.304 3.49.997.108-.776.42-1.306.763-1.605-2.665-.305-5.467-1.334-5.467-5.93 0-1.312.47-2.382 1.236-3.222-.125-.303-.536-1.524.116-3.176 0 0 1.008-.322 3.3 1.23A11.51 11.51 0 0 1 12 5.803c1.02.005 2.047.138 3.006.404 2.29-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.236 1.91 1.236 3.22 0 4.61-2.807 5.625-5.48 5.922.43.372.824 1.102.824 2.222v3.293c0 .32.192.694.8.576C20.567 21.796 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg></span><span class="sr-text" data-reactid="16">GitHub</span></a><a href="https://www.linkedin.com/in/carlosfiloteo" class="Ezg15" data-reactid="17"><span class="SVGInline SVGInline--cleaned" data-reactid="18"><svg class="SVGInline-svg SVGInline--cleaned-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.98 3.5c0 1.381-1.11 2.5-2.48 2.5s-2.48-1.119-2.48-2.5c0-1.38 1.11-2.5 2.48-2.5s2.48 1.12 2.48 2.5zm.02 4.5h-5v16h5v-16zm7.982 0h-4.968v16h4.969v-8.399c0-4.67 6.029-5.052 6.029 0v8.399h4.988v-10.131c0-7.88-8.922-7.593-11.018-3.714v-2.155z"/></svg></span><span class="sr-text" data-reactid="19">LinkedIn</span></a></div></nav></header><div class="_116Tm" data-reactid="20"><div class="sFWsg" data-reactid="21"><!-- react-empty: 22 --><div class="_3p2ZP" style="background:#111 url(/assets/bldg.jpg) 50% 50% / cover;" data-reactid="23"><div class="_3wrxV" data-reactid="24"><div class="hOK0m" data-reactid="25"><h1 class="_1Tkeg" data-reactid="26">An Angular Modal</h1></div></div></div><div class="hOK0m _1z1n5" data-reactid="27"><div data-reactid="28"><header class="_2BJ2-" data-reactid="29"><time data-reactid="30">Mon Feb 13 2017</time></header></div><div class="_30RKo" data-reactid="31"><div class="phenomic-BodyContainer" data-reactid="32"><p>This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the things to do, not do, and to always remember. Let's get to it.</p>
<h3 id="requirements"><a href="#requirements" class="phenomic-HeadingAnchor">#</a>Requirements</h3>
<p>Here are some requirements during this build that will help guide the implementation and serve as the basis for testing. It should:</p>
<ul>
<li>Have a backdrop</li>
<li>Open modal</li>
<li>Close modal</li>
<li>Prevent background scrolling when open</li>
<li>
<p>Accessible<sup>*</sup></p>
<ul>
<li>Prevent losing focus when open</li>
<li>Close with <kbd>ESC</kbd></li>
<li>Return focus to trigger on close</li>
</ul>
</li>
<li>Animate on open/close</li>
</ul>
<p class="note">
    * This is main motivation for writing this post.
</p>
<h3 id="template"><a href="#template" class="phenomic-HeadingAnchor">#</a>Template</h3>
<p>Let's start with laying out the template. This way we know what goes where.</p>
<pre><code>&#x3C;div class="backdrop" #modal>
    &#x3C;div class="contents" role="dialog">
        &#x3C;div>
            &#x3C;ng-content>&#x3C;/ng-content>
        &#x3C;/div>
        &#x3C;footer>
            &#x3C;button class="closeBtn">Close&#x3C;/button>
        &#x3C;/footer>
    &#x3C;/div>
&#x3C;/div>
</code></pre>
<p>We have a <code>.backdrop</code> element that will be a dark translucent color to provide additional focus to the modal content (fullfills requirement 1 already üéâ). The <code>#modal</code> syntax creates a local ref that we'll use later. The <code>.contents</code> element will contain the projected content via  <code>&#x3C;ng-content></code>. The <code>footer</code> aligns the <code>.closeBtn</code>. In order to help keep the focus of this article, I've excluded the <a href="https://github.com/filoxo/an-angular-modal/blob/master/src/app/app.component.css">modal component styles</a>. Visit the link to get them.</p>
<h3 id="use-in-app"><a href="#use-in-app" class="phenomic-HeadingAnchor">#</a>Use in App</h3>
<p>In order to continue developing this component, it'll have to be rendered. Let's add an instance of it to the app component, as well as a few buttons that will trigger it to open. In the App component template, add:</p>
<pre><code>&#x3C;app-modal #myModal>This is my modal&#x3C;/app-modal>
&#x3C;section class="red">
    &#x3C;p>Top&#x3C;/p>
    &#x3C;button (click)="myModal.open()">Open&#x3C;/button>
&#x3C;/section>
</code></pre>
<h3 id="open-and-close-modal"><a href="#open-and-close-modal" class="phenomic-HeadingAnchor">#</a>Open and close modal</h3>
<p>Let's add some real functionality to this component now. <code>show</code> will be the private member used to store the display state. We'll expose changing this state via <code>open()</code> and <code>close()</code> methods.</p>
<pre><code>export class ModalComponent {
    private show: boolean = false;
    ...
    open() {
        this.show = true;
    }

    close() {
        this.show = false;
    }
}
</code></pre>
<p>In conjunction, our template can use the <code>*ngIf</code> directive to display the content conditionally. Wire up the backdrop and the close button to the <code>close</code> method. Also, prevent clicks from bubbling up so the modal doesn't close if you click inside of it.</p>
<pre><code>&#x3C;div class="backdrop" #modal *ngIf="show" (click)="close()">
    &#x3C;div class="contents" (click)="$event.stopPropagation()">
        ...
        &#x3C;button class="closeBtn" (click)="close()">Close&#x3C;/button>
    &#x3C;/div>
&#x3C;/div>
</code></pre>
<p>Adding event emitters will allow us to know if a modal is opened or closed, and emit events on open and close. Add the following to the component;</p>
<pre><code>import { ..., Output, EventEmitter } from '@angular/core';
...
export class ModalComponent {
    @Output() opened = new EventEmitter&#x3C;any>();
    @Output() closed = new EventEmitter&#x3C;any>();
    ...
    open() {
        ...
        this.opened.emit(null);
    }

    close() {
        ...
        this.closed.emit(null)
    }
}
</code></pre>
<p>Done with requirements 2 &#x26; 3 üëã !</p>
<h3 id="prevent-background-scrolling-when-open"><a href="#prevent-background-scrolling-when-open" class="phenomic-HeadingAnchor">#</a>Prevent background scrolling when open</h3>
<p>This one is fairly easy: get the html element, and set it's <code>overflow</code> property based on the modal state. Here's what was added to the modal component.</p>
<pre><code>export class ModalComponent{
    ...
    private html: HTMLElement = document.querySelector('html');
    ...

    open() {
        ...
        this.preventBgScrolling();
    }

    close() {
        ...
        this.preventBgScrolling();
    }

    private preventBgScrolling() {
        this.html.style.overflow = this.show ? 'hidden' : '';
    }
}
</code></pre>
<p>#4 is completed üëç</p>
<h3 id="accessiblity"><a href="#accessiblity" class="phenomic-HeadingAnchor">#</a>Accessiblity</h3>
<p>Accessibility should never be an after thought. Though we're taking this on fairly late in development, its so that we had the proper structure and state in order to reflect the UI non-visually.</p>
<p>We started by adding <code>role="dialog"</code> to the modal <code>.contents</code>. However, adding that role alone is not sufficient to make a dialog accessible. Additionally, the dialog must be properly labeled and keyboard focus must be managed correctly.</p>
<p>In order to poperly label the dialog, we'll use both <code>aria-labelledby</code> and <code>aria-describedby</code>. The labelledby value will apply to a title option that won't be required; since its not required, the describedby value will be a fallback to provide the needed info.
In order to do this, the modal needs a unique ID that we'll use to prefix the IDs of these other elements. I won't make the ID required either, letting the component generate one if needed. Here's how that turned out:</p>
<pre><code>import { ..., OnInit, Input } from '@angular/core';

interface ModalConfig extends Object {
    title?: string;
    id?: string;
}

const defaultConfig = &#x3C;ModalConfig> {};

let id = 0;

...
export class ModalComponent implements OnInit {
    @Input() options: ModalConfig;
    ...
    ngOnInit() {
        const options = Object.assign({}, defaultConfig, this.options);
        this.id = options.id || `modal-${id++}`;
        this.titleId = `${this.id}-title`;
        this.contentId = `${this.id}-content`;
    }
}
</code></pre>
<p>Let me explain what's going on here. We declare a config interface in order to define the available options. If we wanted default options, we could establish those in <code>defaultConfig</code>. The <code>id</code> value will exist in the global classspace and will increment after being used (I found this neat trick in the Angular Material project). Next, we receive an input of type <code>ModalConfig</code> and merge it with the <code>defaultConfig</code>. If no ID is passed in, then a new one is generated automatically.</p>
<pre><code>&#x3C;div class="contents" role="dialog" id="{{ id }}"
    [attr.aria-labelledby]="title ? titleId : null"
    [attr.aria-describedby]="contentId">
    &#x3C;h2 class="title" id="{{ titleId }}" *ngIf="title">{{ title }}&#x3C;/h2>
    &#x3C;div id="{{ contentId }}">...&#x3C;/div>
&#x3C;/div>
</code></pre>
<p>The template is then enhanced by adding the IDs, a dynamic title element that renders only if a <code>title</code> option was passed in, and binds the <code>labelledby</code> and <code>describedby</code> attrs. If there is no <code>title</code> option, the <code>labelledby</code> attr isn't rendered.</p>
<h4 id="prevent-losing-focus-when-open"><a href="#prevent-losing-focus-when-open" class="phenomic-HeadingAnchor">#</a>Prevent losing focus when open</h4>
<p>First, focus needs to be given inside the modal. Then focus should be kept inside the modal as long as its open.</p>
<h4 id="close-with-kbdesckbd"><a href="#close-with-kbdesckbd" class="phenomic-HeadingAnchor">#</a>Close with <kbd>ESC</kbd></h4>
<h4 id="return-focus-to-trigger-on-close"><a href="#return-focus-to-trigger-on-close" class="phenomic-HeadingAnchor">#</a>Return focus to trigger on close</h4>
<h3 id="animations"><a href="#animations" class="phenomic-HeadingAnchor">#</a>Animations</h3>
<h3 id="improvements"><a href="#improvements" class="phenomic-HeadingAnchor">#</a>Improvements</h3>
<p>The above is a pretty good modal but perhaps it doesn't meet all of your requirements. Here are some feature that you could add:</p>
<ul>
<li>Add additional action buttons that can be enabled/disabled as options</li>
</ul>
</div></div><hr data-reactid="33"/><div data-reactid="34"><h2 class="_1vSY4" data-reactid="35">Latest Posts</h2><div data-reactid="36"><ul class="lfRQE" data-reactid="37"><li data-reactid="38"><article class="_1eeKI" data-reactid="39"><a class="_2mH_g" href="/posts/practical-thoughts-on-react-and-angular/" data-reactid="40">Practical thoughts on React and Angular</a><div class="_2l2N1" data-reactid="41"><time data-reactid="42">Tue May 30 2017</time></div><p class="_1-sEy" data-reactid="43"><!-- react-text: 44 -->I sometimes see developers ask &quot;Should I use React, or Angular, or Vue.js, or \[insert new framework here]?&quot; and every time, I see fanatics‚Ä¶<!-- /react-text --><!-- react-text: 45 --> <!-- /react-text --></p><div data-reactid="46"><a class="niUXw _1mmZb" href="/posts/practical-thoughts-on-react-and-angular/" data-reactid="47">Read More ‚Üí</a></div></article></li><li data-reactid="48"><article class="_1eeKI" data-reactid="49"><a class="_2mH_g" href="/posts/thoughts-on-angular-ngcontent/" data-reactid="50">Thoughts on Angular: Ng-Content</a><div class="_2l2N1" data-reactid="51"><time data-reactid="52">Tue Apr 04 2017</time></div><p class="_1-sEy" data-reactid="53"><!-- react-text: 54 -->I recently came across some interesting behavior with Angular&#x27;s ng-content that I wanted to jot down so I can search for some answers.‚Ä¶<!-- /react-text --><!-- react-text: 55 --> <!-- /react-text --></p><div data-reactid="56"><a class="niUXw _1mmZb" href="/posts/thoughts-on-angular-ngcontent/" data-reactid="57">Read More ‚Üí</a></div></article></li><li data-reactid="58"><article class="_1eeKI" data-reactid="59"><a class="_2mH_g" href="/posts/build-a-css-framework-using-npm/" data-reactid="60">Building a CSS framework using npm</a><div class="_2l2N1" data-reactid="61"><time data-reactid="62">Mon Feb 13 2017</time></div><p class="_1-sEy" data-reactid="63"><!-- react-text: 64 -->This last weekend I wanted to create a simple CSS framework that I can reuse for my own little projects. The end result is Simple Style‚Ä¶<!-- /react-text --><!-- react-text: 65 --> <!-- /react-text --></p><div data-reactid="66"><a class="niUXw _1mmZb" href="/posts/build-a-css-framework-using-npm/" data-reactid="67">Read More ‚Üí</a></div></article></li><li data-reactid="68"><article class="_1eeKI" data-reactid="69"><a class="_2mH_g" href="/posts/an-angular-modal/" data-reactid="70">An Angular Modal</a><div class="_2l2N1" data-reactid="71"><time data-reactid="72">Mon Feb 13 2017</time></div><p class="_1-sEy" data-reactid="73"><!-- react-text: 74 -->This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the‚Ä¶<!-- /react-text --><!-- react-text: 75 --> <!-- /react-text --></p><div data-reactid="76"><a class="niUXw _1mmZb" href="/posts/an-angular-modal/" data-reactid="77">Read More ‚Üí</a></div></article></li><li data-reactid="78"><article class="_1eeKI" data-reactid="79"><a class="_2mH_g" href="/posts/crossplatform-revisited/" data-reactid="80">Cross-platform Revisited</a><div class="_2l2N1" data-reactid="81"><time data-reactid="82">Sat Feb 04 2017</time></div><p class="_1-sEy" data-reactid="83"><!-- react-text: 84 -->Time has passed, technology has improved, and my preferences have also changed. In this post I&#x27;ll revisit my choice of tooling.  Password‚Ä¶<!-- /react-text --><!-- react-text: 85 --> <!-- /react-text --></p><div data-reactid="86"><a class="niUXw _1mmZb" href="/posts/crossplatform-revisited/" data-reactid="87">Read More ‚Üí</a></div></article></li><li data-reactid="88"><article class="_1eeKI" data-reactid="89"><a class="_2mH_g" href="/posts/recommended-resources/" data-reactid="90">Recommended Resources</a><div class="_2l2N1" data-reactid="91"><time data-reactid="92">Wed Sep 21 2016</time></div><p class="_1-sEy" data-reactid="93"><!-- react-text: 94 -->There are lots of great resources out there for the front-end developer who wants to keep learning. I know that I&#x27;ve been able to glean‚Ä¶<!-- /react-text --><!-- react-text: 95 --> <!-- /react-text --></p><div data-reactid="96"><a class="niUXw _1mmZb" href="/posts/recommended-resources/" data-reactid="97">Read More ‚Üí</a></div></article></li></ul></div></div></div></div></div><footer class="_1Ustb" data-reactid="98"><p class="_21LuU" data-reactid="99"><!-- react-text: 100 -->¬© <!-- /react-text --><!-- react-text: 101 -->2017<!-- /react-text --><!-- react-text: 102 --> | <!-- /react-text --><!-- react-text: 103 -->Made with <!-- /react-text --><a href="https://phenomic.io" data-reactid="104"><span class="MMp-P" data-reactid="105">&lt;Phenomic /&gt;</span></a></p></footer></div></div><script>window.__COLLECTION__ = [{"layout":"PageError","route":"404.html","description":"","__filename":"404.md","__url":"/404.html","__resourceUrl":"/404.html","__dataUrl":"/404.html.7f6093458561a2a9bb2178ef2cba0f0f.json"},{"title":"About me","hero":"https://farm4.staticflickr.com/3949/15589950511_3675b15e59_k.jpg","cta":{"label":"Discover Phenomic now","link":"https://phenomic.io/","props":{"big":true}},"description":"","__filename":"about.md","__url":"/about/","__resourceUrl":"/about/index.html","__dataUrl":"/about/index.html.0721531ea21302c88bfbcfd666bc9bb3.json"},{"title":"Filoblog","layout":"Homepage","hero":"../assets/main.jpg","description":"Hi, welcome to Filoblog. This is the place where I share some of my thoughts, advice, and ideas. Enjoy!","__filename":"index.md","__url":"/","__resourceUrl":"/index.html","__dataUrl":"/index.html.f6dcd63a5f63b584e22084408babae89.json"},{"title":"Firebase Email Auth and Validation","date":"2016-07-28T00:00:00.000Z","layout":"Post","tags":"firebase","description":"If you use Firebase, you'd be inclined to use their authentication for you system because of how amazingly easy it is to get started. They‚Ä¶","__filename":"posts/Firebase-Email-Auth-and-Validation.md","__url":"/posts/Firebase-Email-Auth-and-Validation/","__resourceUrl":"/posts/Firebase-Email-Auth-and-Validation/index.html","__dataUrl":"/posts/Firebase-Email-Auth-and-Validation/index.html.caa095b576bec965814b60e85ddd2bfa.json"},{"title":"Install zsh on Mac without homebrew","date":"2016-07-28T00:00:00.000Z","layout":"Post","tags":"mac","description":"I'm not a big supporter of Homebrew. It just doesn't solve any problems for me. I have only needed brew for zsh and maybe node (but for‚Ä¶","__filename":"posts/Install-zsh-on-Mac-without-homebrew.md","__url":"/posts/Install-zsh-on-Mac-without-homebrew/","__resourceUrl":"/posts/Install-zsh-on-Mac-without-homebrew/index.html","__dataUrl":"/posts/Install-zsh-on-Mac-without-homebrew/index.html.a260797a8dbf85fe07f9680de973da4b.json"},{"title":"Must-have Apps: Cross-platform edition","date":"2016-07-28T00:00:00.000Z","layout":"Post","description":"I believe that developers can benefit and learn from others' favorite suite of tools. I'll go over my favorite applications that help me be‚Ä¶","__filename":"posts/Must-have-Apps-Cross-platform-edition.md","__url":"/posts/Must-have-Apps-Cross-platform-edition/","__resourceUrl":"/posts/Must-have-Apps-Cross-platform-edition/index.html","__dataUrl":"/posts/Must-have-Apps-Cross-platform-edition/index.html.33012d63a783640ad0ed8271b9e4edd3.json"},{"title":"Must-have Apps: Mac edition","date":"2016-07-28T00:00:00.000Z","layout":"Post","description":"I believe that developers can benefit and learn from others' favorite suite of tools. I'll go over my favorite applications that help me be‚Ä¶","__filename":"posts/Must-have-Apps-Mac-edition.md","__url":"/posts/Must-have-Apps-Mac-edition/","__resourceUrl":"/posts/Must-have-Apps-Mac-edition/index.html","__dataUrl":"/posts/Must-have-Apps-Mac-edition/index.html.ef1f26835b5483a30b7a9c40c68597b3.json"},{"title":"Must-have Apps: Windows edition","date":"2016-07-28T00:00:00.000Z","layout":"Post","description":"I believe that developers can benefit and learn from others' favorite suite of tools. I'll go over my favorite applications that help me be‚Ä¶","__filename":"posts/Must-have-Apps-Windows-edition.md","__url":"/posts/Must-have-Apps-Windows-edition/","__resourceUrl":"/posts/Must-have-Apps-Windows-edition/index.html","__dataUrl":"/posts/Must-have-Apps-Windows-edition/index.html.787a0bb65a0d04e2c3423e640535417f.json"},{"title":"An Angular Modal","date":"2017-02-14T00:00:00.000Z","layout":"Post","hero":"/assets/bldg.jpg","description":"This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the‚Ä¶","__filename":"posts/an-angular-modal.md","__url":"/posts/an-angular-modal/","__resourceUrl":"/posts/an-angular-modal/index.html","__dataUrl":"/posts/an-angular-modal/index.html.db587ebb29145abc17911dd957e609fe.json"},{"title":"Building a CSS framework using npm","date":"2017-02-14T00:00:00.000Z","layout":"Post","hero":"/assets/leaves.jpg","description":"This last weekend I wanted to create a simple CSS framework that I can reuse for my own little projects. The end result is Simple Style‚Ä¶","__filename":"posts/build-a-css-framework-using-npm.md","__url":"/posts/build-a-css-framework-using-npm/","__resourceUrl":"/posts/build-a-css-framework-using-npm/index.html","__dataUrl":"/posts/build-a-css-framework-using-npm/index.html.a37512e30431d8f96cd8da836c6a4509.json"},{"title":"Cross-platform Revisited","date":"2017-02-05T00:00:00.000Z","layout":"Post","hero":"/assets/crossplatform.jpg","description":"Time has passed, technology has improved, and my preferences have also changed. In this post I'll revisit my choice of tooling.  Password‚Ä¶","__filename":"posts/crossplatform-revisited.md","__url":"/posts/crossplatform-revisited/","__resourceUrl":"/posts/crossplatform-revisited/index.html","__dataUrl":"/posts/crossplatform-revisited/index.html.17712f2010b1d91e60885f92707a49f8.json"},{"title":"First Post, no hero.","date":"2016-01-22T00:00:00.000Z","layout":"Post","description":"This is the first post! Code is highlighted by default.","__filename":"posts/first-post.md","__url":"/posts/first-post/","__resourceUrl":"/posts/first-post/index.html","__dataUrl":"/posts/first-post/index.html.4a901bdda70903f928f491360ea7c01b.json"},{"title":"Welcome back to the future of static website!","date":"2016-02-14T00:00:00.000Z","layout":"Post","hero":"https://farm8.staticflickr.com/7479/15669216853_aa8e70eae1_o.jpg","description":"Ahh. Hey, Doc, we better back up, we don't have enough roads to get up to 88. Hi. Where were we. In that case, I'll tell you strait out.‚Ä¶","__filename":"posts/hello-world.md","__url":"/posts/hello-world/","__resourceUrl":"/posts/hello-world/index.html","__dataUrl":"/posts/hello-world/index.html.f447e4f06503aa291673225c18787760.json"},{"title":"Practical thoughts on React and Angular","date":"2017-05-31T00:00:00.000Z","layout":"Post","hero":"/assets/oil-in-water.jpg","description":"I sometimes see developers ask \"Should I use React, or Angular, or Vue.js, or \\[insert new framework here]?\" and every time, I see fanatics‚Ä¶","__filename":"posts/practical-thoughts-on-react-and-angular.md","__url":"/posts/practical-thoughts-on-react-and-angular/","__resourceUrl":"/posts/practical-thoughts-on-react-and-angular/index.html","__dataUrl":"/posts/practical-thoughts-on-react-and-angular/index.html.fc85c9ba0b3f393421c6f17d0312b710.json"},{"title":"Recommended Resources","date":"2016-09-22T00:00:00.000Z","layout":"Post","tags":"javascript","description":"There are lots of great resources out there for the front-end developer who wants to keep learning. I know that I've been able to glean‚Ä¶","__filename":"posts/recommended-resources.md","__url":"/posts/recommended-resources/","__resourceUrl":"/posts/recommended-resources/index.html","__dataUrl":"/posts/recommended-resources/index.html.7458e78c1ce0ab648bf95fe26d71a6b1.json"},{"title":"Thoughts on Angular: Ng-Content","date":"2017-04-05T00:00:00.000Z","layout":"Post","hero":"/assets/bldg-angle.jpg","description":"I recently came across some interesting behavior with Angular's ng-content that I wanted to jot down so I can search for some answers.‚Ä¶","__filename":"posts/thoughts-on-angular-ngcontent.md","__url":"/posts/thoughts-on-angular-ngcontent/","__resourceUrl":"/posts/thoughts-on-angular-ngcontent/index.html","__dataUrl":"/posts/thoughts-on-angular-ngcontent/index.html.e9f251e5c0a82502d5643cc1663f08a5.json"}];window.__INITIAL_STATE__ = {"pages":{"/posts/an-angular-modal/":{"head":{"title":"An Angular Modal","date":"2017-02-14T00:00:00.000Z","layout":"Post","hero":"/assets/bldg.jpg","description":"This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the‚Ä¶"},"body":"<p>This post is just an exercise in creating a modal in Angular (~2 at the time of this writing). Hopefully it can shed light on some of the things to do, not do, and to always remember. Let's get to it.</p>\n<h3 id=\"requirements\"><a href=\"#requirements\" class=\"phenomic-HeadingAnchor\">#</a>Requirements</h3>\n<p>Here are some requirements during this build that will help guide the implementation and serve as the basis for testing. It should:</p>\n<ul>\n<li>Have a backdrop</li>\n<li>Open modal</li>\n<li>Close modal</li>\n<li>Prevent background scrolling when open</li>\n<li>\n<p>Accessible<sup>*</sup></p>\n<ul>\n<li>Prevent losing focus when open</li>\n<li>Close with <kbd>ESC</kbd></li>\n<li>Return focus to trigger on close</li>\n</ul>\n</li>\n<li>Animate on open/close</li>\n</ul>\n<p class=\"note\">\n    * This is main motivation for writing this post.\n</p>\n<h3 id=\"template\"><a href=\"#template\" class=\"phenomic-HeadingAnchor\">#</a>Template</h3>\n<p>Let's start with laying out the template. This way we know what goes where.</p>\n<pre><code>&#x3C;div class=\"backdrop\" #modal>\n    &#x3C;div class=\"contents\" role=\"dialog\">\n        &#x3C;div>\n            &#x3C;ng-content>&#x3C;/ng-content>\n        &#x3C;/div>\n        &#x3C;footer>\n            &#x3C;button class=\"closeBtn\">Close&#x3C;/button>\n        &#x3C;/footer>\n    &#x3C;/div>\n&#x3C;/div>\n</code></pre>\n<p>We have a <code>.backdrop</code> element that will be a dark translucent color to provide additional focus to the modal content (fullfills requirement 1 already üéâ). The <code>#modal</code> syntax creates a local ref that we'll use later. The <code>.contents</code> element will contain the projected content via  <code>&#x3C;ng-content></code>. The <code>footer</code> aligns the <code>.closeBtn</code>. In order to help keep the focus of this article, I've excluded the <a href=\"https://github.com/filoxo/an-angular-modal/blob/master/src/app/app.component.css\">modal component styles</a>. Visit the link to get them.</p>\n<h3 id=\"use-in-app\"><a href=\"#use-in-app\" class=\"phenomic-HeadingAnchor\">#</a>Use in App</h3>\n<p>In order to continue developing this component, it'll have to be rendered. Let's add an instance of it to the app component, as well as a few buttons that will trigger it to open. In the App component template, add:</p>\n<pre><code>&#x3C;app-modal #myModal>This is my modal&#x3C;/app-modal>\n&#x3C;section class=\"red\">\n    &#x3C;p>Top&#x3C;/p>\n    &#x3C;button (click)=\"myModal.open()\">Open&#x3C;/button>\n&#x3C;/section>\n</code></pre>\n<h3 id=\"open-and-close-modal\"><a href=\"#open-and-close-modal\" class=\"phenomic-HeadingAnchor\">#</a>Open and close modal</h3>\n<p>Let's add some real functionality to this component now. <code>show</code> will be the private member used to store the display state. We'll expose changing this state via <code>open()</code> and <code>close()</code> methods.</p>\n<pre><code>export class ModalComponent {\n    private show: boolean = false;\n    ...\n    open() {\n        this.show = true;\n    }\n\n    close() {\n        this.show = false;\n    }\n}\n</code></pre>\n<p>In conjunction, our template can use the <code>*ngIf</code> directive to display the content conditionally. Wire up the backdrop and the close button to the <code>close</code> method. Also, prevent clicks from bubbling up so the modal doesn't close if you click inside of it.</p>\n<pre><code>&#x3C;div class=\"backdrop\" #modal *ngIf=\"show\" (click)=\"close()\">\n    &#x3C;div class=\"contents\" (click)=\"$event.stopPropagation()\">\n        ...\n        &#x3C;button class=\"closeBtn\" (click)=\"close()\">Close&#x3C;/button>\n    &#x3C;/div>\n&#x3C;/div>\n</code></pre>\n<p>Adding event emitters will allow us to know if a modal is opened or closed, and emit events on open and close. Add the following to the component;</p>\n<pre><code>import { ..., Output, EventEmitter } from '@angular/core';\n...\nexport class ModalComponent {\n    @Output() opened = new EventEmitter&#x3C;any>();\n    @Output() closed = new EventEmitter&#x3C;any>();\n    ...\n    open() {\n        ...\n        this.opened.emit(null);\n    }\n\n    close() {\n        ...\n        this.closed.emit(null)\n    }\n}\n</code></pre>\n<p>Done with requirements 2 &#x26; 3 üëã !</p>\n<h3 id=\"prevent-background-scrolling-when-open\"><a href=\"#prevent-background-scrolling-when-open\" class=\"phenomic-HeadingAnchor\">#</a>Prevent background scrolling when open</h3>\n<p>This one is fairly easy: get the html element, and set it's <code>overflow</code> property based on the modal state. Here's what was added to the modal component.</p>\n<pre><code>export class ModalComponent{\n    ...\n    private html: HTMLElement = document.querySelector('html');\n    ...\n\n    open() {\n        ...\n        this.preventBgScrolling();\n    }\n\n    close() {\n        ...\n        this.preventBgScrolling();\n    }\n\n    private preventBgScrolling() {\n        this.html.style.overflow = this.show ? 'hidden' : '';\n    }\n}\n</code></pre>\n<p>#4 is completed üëç</p>\n<h3 id=\"accessiblity\"><a href=\"#accessiblity\" class=\"phenomic-HeadingAnchor\">#</a>Accessiblity</h3>\n<p>Accessibility should never be an after thought. Though we're taking this on fairly late in development, its so that we had the proper structure and state in order to reflect the UI non-visually.</p>\n<p>We started by adding <code>role=\"dialog\"</code> to the modal <code>.contents</code>. However, adding that role alone is not sufficient to make a dialog accessible. Additionally, the dialog must be properly labeled and keyboard focus must be managed correctly.</p>\n<p>In order to poperly label the dialog, we'll use both <code>aria-labelledby</code> and <code>aria-describedby</code>. The labelledby value will apply to a title option that won't be required; since its not required, the describedby value will be a fallback to provide the needed info.\nIn order to do this, the modal needs a unique ID that we'll use to prefix the IDs of these other elements. I won't make the ID required either, letting the component generate one if needed. Here's how that turned out:</p>\n<pre><code>import { ..., OnInit, Input } from '@angular/core';\n\ninterface ModalConfig extends Object {\n    title?: string;\n    id?: string;\n}\n\nconst defaultConfig = &#x3C;ModalConfig> {};\n\nlet id = 0;\n\n...\nexport class ModalComponent implements OnInit {\n    @Input() options: ModalConfig;\n    ...\n    ngOnInit() {\n        const options = Object.assign({}, defaultConfig, this.options);\n        this.id = options.id || `modal-${id++}`;\n        this.titleId = `${this.id}-title`;\n        this.contentId = `${this.id}-content`;\n    }\n}\n</code></pre>\n<p>Let me explain what's going on here. We declare a config interface in order to define the available options. If we wanted default options, we could establish those in <code>defaultConfig</code>. The <code>id</code> value will exist in the global classspace and will increment after being used (I found this neat trick in the Angular Material project). Next, we receive an input of type <code>ModalConfig</code> and merge it with the <code>defaultConfig</code>. If no ID is passed in, then a new one is generated automatically.</p>\n<pre><code>&#x3C;div class=\"contents\" role=\"dialog\" id=\"{{ id }}\"\n    [attr.aria-labelledby]=\"title ? titleId : null\"\n    [attr.aria-describedby]=\"contentId\">\n    &#x3C;h2 class=\"title\" id=\"{{ titleId }}\" *ngIf=\"title\">{{ title }}&#x3C;/h2>\n    &#x3C;div id=\"{{ contentId }}\">...&#x3C;/div>\n&#x3C;/div>\n</code></pre>\n<p>The template is then enhanced by adding the IDs, a dynamic title element that renders only if a <code>title</code> option was passed in, and binds the <code>labelledby</code> and <code>describedby</code> attrs. If there is no <code>title</code> option, the <code>labelledby</code> attr isn't rendered.</p>\n<h4 id=\"prevent-losing-focus-when-open\"><a href=\"#prevent-losing-focus-when-open\" class=\"phenomic-HeadingAnchor\">#</a>Prevent losing focus when open</h4>\n<p>First, focus needs to be given inside the modal. Then focus should be kept inside the modal as long as its open.</p>\n<h4 id=\"close-with-kbdesckbd\"><a href=\"#close-with-kbdesckbd\" class=\"phenomic-HeadingAnchor\">#</a>Close with <kbd>ESC</kbd></h4>\n<h4 id=\"return-focus-to-trigger-on-close\"><a href=\"#return-focus-to-trigger-on-close\" class=\"phenomic-HeadingAnchor\">#</a>Return focus to trigger on close</h4>\n<h3 id=\"animations\"><a href=\"#animations\" class=\"phenomic-HeadingAnchor\">#</a>Animations</h3>\n<h3 id=\"improvements\"><a href=\"#improvements\" class=\"phenomic-HeadingAnchor\">#</a>Improvements</h3>\n<p>The above is a pretty good modal but perhaps it doesn't meet all of your requirements. Here are some feature that you could add:</p>\n<ul>\n<li>Add additional action buttons that can be enabled/disabled as options</li>\n</ul>\n","__filename":"posts/an-angular-modal.md","__url":"/posts/an-angular-modal/","__resourceUrl":"/posts/an-angular-modal/index.html","__dataUrl":"/posts/an-angular-modal/index.html.db587ebb29145abc17911dd957e609fe.json","type":"Post"}}}</script><script src="/phenomic.browser.4b24f5ff56450456ebf3.js"></script></body></html>