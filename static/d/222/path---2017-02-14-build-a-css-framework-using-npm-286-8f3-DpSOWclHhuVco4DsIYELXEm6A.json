{"data":{"mdx":null,"markdownRemark":{"__typename":"MarkdownRemark","html":"<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/add274474afb2aa4bd26d33be9de68c4/c1266/leaves.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAME/9oADAMBAAIQAxAAAAG6IFGsKP8A/8QAGBAAAwEBAAAAAAAAAAAAAAAAAQIDEjP/2gAIAQEAAQUCDHdGYCfP/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEDMf/aAAgBAwEBPwGaHp//xAAVEQEBAAAAAAAAAAAAAAAAAAAQQv/aAAgBAgEBPwGj/8QAGBABAAMBAAAAAAAAAAAAAAAAAAECETH/2gAIAQEABj8Cl1XX/8QAFxABAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAQABPyEB3AOastcv/9oADAMBAAIAAwAAABB8H//EABgRAQEAAwAAAAAAAAAAAAAAAAEAITFx/9oACAEDAQE/EATJbu3/xAAVEQEBAAAAAAAAAAAAAAAAAAAQUf/aAAgBAgEBPxCD/8QAGhABAAMAAwAAAAAAAAAAAAAAAQARIUFRYf/aAAgBAQABPxC0WDR5hBdR7JegNrzP/9k='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"\"Leaves\"\"\n        title=\"\"\n        src=\"/static/add274474afb2aa4bd26d33be9de68c4/f8fb9/leaves.jpg\"\n        srcset=\"/static/add274474afb2aa4bd26d33be9de68c4/e8976/leaves.jpg 148w,\n/static/add274474afb2aa4bd26d33be9de68c4/63df2/leaves.jpg 295w,\n/static/add274474afb2aa4bd26d33be9de68c4/f8fb9/leaves.jpg 590w,\n/static/add274474afb2aa4bd26d33be9de68c4/85e3d/leaves.jpg 885w,\n/static/add274474afb2aa4bd26d33be9de68c4/d1924/leaves.jpg 1180w,\n/static/add274474afb2aa4bd26d33be9de68c4/c1266/leaves.jpg 1200w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>This last weekend I wanted to create a simple CSS framework that I can reuse for my own little projects. The end result is <a href=\"https://github.com/filoxo/simple-style\">Simple Style</a> (which is still a WIP as requirements come up). Surprisingly, using <a href=\"https://medium.com/@dabit3/introduction-to-using-npm-as-a-build-tool-b41076f488b0#.5w4loc8uy\">npm as a build tool</a> made it extremely easy to set up a dev environment. I'll review everything about the setup in this post for my own documentation, but hopefully can also serve as a clean, straightforward example.</p>\n<p>I used <a href=\"https://yarnpkg.com/en/\"><code>yarn</code></a> for this experiment instead of <code>npm</code> solely for the speed improvements. Fortunately, <code>yarn</code>'s commands all have their <code>npm</code> equivalents so don't get hung up on the differences.</p>\n<p>This basic setup offers:</p>\n<ul>\n<li>Autoprefixing to support the 2 latest browsers</li>\n<li>Future CSS syntax usable today</li>\n<li>minification</li>\n<li>optimizations</li>\n<li>a quick and easy development setup to reflect changes on-the-fly</li>\n</ul>\n<h3>Dev dependencies</h3>\n<p>Here are our initial development dependencies:</p>\n<ul>\n<li><a href=\"https://necolas.github.io/normalize.css/\">normalize.css</a>: so that all elements render consistently</li>\n<li><a href=\"https://github.com/postcss/postcss\">PostCSS</a>'s CLI: to leverage its ecosystem of feature plugins</li>\n<li><a href=\"http://cssnext.io/\">CSSnext</a>: a PostCSS plugin that helps you to use the latest CSS syntax today. This way the code will be a little more future-proof. Additionally, CSSnext also includes <a href=\"https://github.com/postcss/autoprefixer\">Autoprefixer</a> as a dependency.</li>\n<li><code>postcss-import</code>: used to pull in a css file that wasn't being preprocessed</li>\n<li><code>cssnano</code>: minify and optimize output</li>\n</ul>\n<p>Install using yarn (or the npm equivalent)</p>\n<pre><code>yarn add -D normalize.css postcss-cli postcss-cssnext postcss-import cssnano\n</code></pre>\n<h3>PostCSS config</h3>\n<p>Create a json file that contains the config for PostCSS. The docs named it <strong>options.json</strong> but I choose <strong>postcss.json</strong> for better clarity. The comments below explain some keys.</p>\n<pre><code>{\n    // Enable plugins in order\n    \"use\": [\n        \"postcss-import\",\n        \"postcss-cssnext\",\n        \"cssnano\"\n    ],\n    \"input\": \"main.css\",\n    \"output\": \"dist/main.css\",\n    // use locally installed plugins (eg. in node_modules)\n    \"local-plugins\": true,\n    // Enable sourcemaps\n    \"map\": true,\n    // CSSnext and cssnano both use autoprefixer, but for different features/purposes\n    // see https://github.com/MoOx/postcss-cssnext/issues/323\n    \"postcss-cssnext\": {\n        \"warnForDuplicates\": false\n    }\n}\n</code></pre>\n<h3>CSS time</h3>\n<p>Go ahead and create <strong>main.css</strong> at the project root. The above config will output to <strong>dist/</strong>. Here's a quick sample to put into the file for now.</p>\n<pre><code>@import('normalize.css');\n\n:root {\n    --color-primary: blue;\n    --color-secondary: red;\n}\n</code></pre>\n<h3>Building</h3>\n<p>Use the postcss-cli with the config file passed in as an arg and save it as an npm script.</p>\n<pre><code>\"scripts\": {\n    \"build\": \"node_modules/postcss-cli/bin/postcss -c postcss.json\"\n}\n</code></pre>\n<p>Now you can simply run <code>yarn run build</code> and your css will be processed and output to <strong>dist</strong>. But we can still do better.</p>\n<h3>Watch for changes</h3>\n<p>Enabling watch will auto-transform the css file on changes. Add another npm script, which is exactly the same as <code>build</code> but with the watch flag.</p>\n<pre><code>\"build:dev\": \"node_modules/postcss-cli/bin/postcss -c postcss.json -w\"\n</code></pre>\n<h3>Livereload</h3>\n<p>You wouldn't develop a CSS framework without seeing it rendered on a page so let's create a test page for development. Create <strong>index.html</strong> at the project root and populate it with some HTML, and add a link to your <strong>main.css</strong> file.</p>\n<pre><code>&#x3C;!doctype html>\n&#x3C;html lang=\"en-US\">\n    &#x3C;head>\n        &#x3C;link rel=\"stylesheet\" href=\"/dist/main.css\">\n    &#x3C;/head>\n    &#x3C;body>\n        &#x3C;main>Hello world&#x3C;/main>\n    &#x3C;/body>\n&#x3C;/html>\n</code></pre>\n<p><a href=\"https://www.npmjs.com/package/lr-http-server\"><code>lr-http-server</code></a> will reload on changes, as well as a functioning http server.</p>\n<pre><code>yarn add -D lr-http-server\n</code></pre>\n<p>And then register a new npm script for it</p>\n<pre><code>\"reload\": \"lr-http-server -p 3000\"\n</code></pre>\n<h3>Composing scripts</h3>\n<p>We want the two above scripts to run in parallel so that if either the css or the html file changes the livereload server will do its job. <a href=\"https://www.npmjs.com/package/npm-run-all\"><code>npm-run-all</code></a> with the <code>-p</code> (parallel) flag does this exactly.</p>\n<pre><code>yarn add -D npm-run-all\n</code></pre>\n<p>Join the two tasks together into a single npm script</p>\n<pre><code>\"start\": \"npm-run-all -p build:dev reload\"\n</code></pre>\n<p>And then run easily with</p>\n<pre><code>yarn start\n</code></pre>\n<h3>Done!</h3>\n<p>You're ready to keep going developing your styles inside <strong>main.css</strong>. Feel free to improve upon this as needed!</p>","frontmatter":{"title":"Building a CSS framework using npm","date":"Feb 14, 2017","tags":["javascript","npm"]}}},"pageContext":{"slug":"/2017-02-14-build-a-css-framework-using-npm/"}}